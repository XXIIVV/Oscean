<!DOCTYPE html><html><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<link href="../links/main.css" type="text/css" rel="stylesheet"><link href="../media/services/icon.png" type="image/png" rel="shortcut icon">
<title>XXIIVV &mdash; fractran</title></head><body>
<header><a href="home.html"><img alt="XXIIVV" src="../media/icon/logo.svg"></a></header>

<nav><ul><li><a href="paper_computing.html">paper computing</a></li><li><a href="ternary_computing.html">ternary computing</a></li><li><a href="parallel_computing.html">parallel computing</a></li><li><a href="reversible_computing.html">reversible computing</a></li><li><a href="programming.html">programming</a></li><li><a href="virtual_machines.html" class="parent">virtual machines</a></li></ul><ul><li><a href="fractran.html" class="self">fractran</a></li><li><a href="orca.html">orca</a></li><li><a href="secd.html">secd</a></li><li><a href="uxn.html">uxn</a></li></ul><ul></ul></nav>
<main><h2>A Fractran program is a list of <a href='fractions.html'>fractions</a> and
an initial positive integer input.</h2>

<p>Any number that can't be divided by any other number, apart from itself and
one, is <a href='primes.html'>prime</a>. Since primes can't be divided, we can
think of them as the DNA of other numbers. In Fractran, each prime is a
register and their exponent is their value. </p>

<figure>
	<img src='../media/refs/fractran.jpg' width='340'/>
	<figcaption>The Book of Numbers, <a href='https://en.wikipedia.org/wiki/John_Horton_Conway' target='_blank'>John Conway</a></figcaption>
</figure>

<h3>The Accumulator</h3>

<p>The state of the <b>Accumulator</b> is held as a single number, whose prime
factorization holds the value of registers(2, 3, 5, 7, 11, 13, 17, ..). For
example, if the state of the accumulator is 1008(2⁴ × 3² × 7), r2 has the
value 4, r3 has the value 2, r7 has the value 1, and all other registers are
unassigned. </p>

<table border='1'>
	<tr><th rowspan='2'>Accumulator</th><th colspan='4'>Registers</th></tr>
	<tr><th>r2</th><th>r3</th><th>r5</th><th>r7</th></tr>
	<tr><th>6</th><td>1</td><td>1</td><td></td><td></td></tr>
	<tr><th>18</th><td>1</td><td>2</td><td></td><td></td></tr>
	<tr><th>1008</th><td>4</td><td>2</td><td></td><td>1</td></tr>
	<tr><th>5402250</th><td>1</td><td>2</td><td>3</td><td>4</td></tr>
</table>

<h3>The Operand</h3>

<img src='../media/refs/fractran.adder1.jpg' width='140px'/>

<p>An <b>Operand</b> is a positive fraction, each fraction represents an
instruction that tests one or more registers, represented by the prime factors
of its numerator and denominator. For example, to evaluate the result of
holding 18 in the accumulator with a fraction operand of <code>2/3</code>, we
will take the state of the accumulator, if multiplying it by this fraction will
give us an integer, we will update the accumulator with the result.</p>

<pre>18(2<sup>1</sup> × 3<sup>2</sup>) <b>2/3</b>(2<sup>+1</sup>, 3<sup>-1</sup>) = 12(2<sup>2</sup> × 3<sup>1</sup>)</pre>

<p>Operations become more readable when broken down into their primes. We can
think of every prime number as having a register which can take on non-negative
integer values. Each fraction is an instruction that operates on some of the
registers.</p>

<table border='1'>
	<tr>
		<th>2/3</th>
		<th>15/256</th>
		<th>21/20</th>
	</tr>
	<tr>
		<td>(<span class='numreg'>2</span><sup class='numval'>1</sup>)/(<span class='denreg'>3</span><sup class='denval'>1</sup>)</td>
		<td>(<span class='numreg'>3</span><sup class='numval'>1</sup> × <span class='numreg'>5</span><sup class='numval'>1</sup>)/(<span class='denreg'>2</span><sup class='denval'>6</sup>)</td>
		<td>(<span class='numreg'>3</span><sup class='numval'>1</sup> × <span class='numreg'>7</span><sup class='numval'>1</sup>)/(<span class='denreg'>2</span><sup class='denval'>2</sup> × <span class='denreg'>5</span><sup class='denval'>1</sup>)</td>
	</tr>
	<tr>
		<td>
<pre>
if(<span class='denreg'>r3</span> >= <span class='denval'>1</span>){ 
	<span class='denreg'>r3</span> -= <span class='denval'>1</span>;
	<span class='numreg'>r2</span> += <span class='numval'>1</span>;
	return;
}</pre>
		</td>
		<td>
<pre>
if(<span class='denreg'>r2</span> >= <span class='denval'>6</span>){ 
	<span class='denreg'>r2</span> -= <span class='denval'>6</span>;
	<span class='numreg'>r3</span> += <span class='numval'>1</span>;
	<span class='numreg'>r5</span> += <span class='numval'>1</span>;
	return;
}</pre>
		</td>
		<td>
<pre>
if(<span class='denreg'>r2</span> >= <span class='denval'>2</span> && <span class='denreg'>r5</span> >= <span class='denval'>1</span>){ 
	<span class='denreg'>r2</span> -= <span class='denval'>2</span>; 
	<span class='denreg'>r5</span> -= <span class='denval'>1</span>; 
	<span class='numreg'>r3</span> += <span class='numval'>1</span>; 
	<span class='numreg'>r7</span> += <span class='numval'>1</span>;
	return;
}</pre>
		</td>
	</tr>
</table>

<h3>The Program</h3>

<p>A <b>Program</b> is a list of fractions distributed over lines together with
an initial positive integer input. A program may have any number of lines, and
a line might have the form:</p>

<img src='../media/refs/fractran.adder3.jpg' width='220px'/>

<pre>
210
1: 1/7 ->2, 1/3 ->1
2: 10/3 ->2, 1/1 ->3
3: 3/5 ->3
</pre>

<p>You can interpret a fraction as saying if the current value of each register
is greater than or equal to the value specified by the denominator, you
subtract from the registers all of the values in the denominator, add all the
values specified in the numerator. If any register is less than the value
specified in the denominator, continue to the next fraction.</p>

<pre>
00 | 210, 2^1 3^1 5^1 7^1
01 | 210 × 1/7 = 30/1, 2^1 3^1 5^1 ->5 
05 | 30 × 10/3 = 100/1, 2^2 5^2 ->5 
05 | 100 × 10/3 = 1000/3, .. 
07 | 100 × 1/1 = 100/1, 2^2 5^2 ->9 
09 | 100 × 3/5 = 60/1, 2^2 3^1 5^1 ->9 
09 | 60 × 3/5 = 36/1, 2^2 3^2 ->9 
09 | 36 × 3/5 = 108/5, .. 
11 | 36, 2^2 3^2
Completed in 8 cycles.
</pre>

<ul>
    <li>For each fraction in the list for which the multiplication of the accumulator and the fraction is an integer, replace the accumulator by the result of that multiplication.</li>
    <li>Repeat this rule until no fraction in the list produces an integer when multiplied by the accumulator, then halt.</li>
</ul>

<h3>Implementation</h3>

<p>The language runtime can be implemented in about <a href='ansi_c.html'>300
lines</a>.</p>

<div class='codeview'>
	<iframe src='../etc/fractran.c.txt'></iframe>
	<pre>cc fractran.c -o fractran <a href='../etc/fractran.c.txt' target='_blank'>view raw</a></pre>
</div>

<p>The runtime expects a program in the format:</p>

<pre>
18                          ; Set accumulator
loop: 2/3 ->loop, 5/2 ->end ; Loop adding values of r2 and r3, and jump to 2
end: 0/0                    ; Terminate.
</pre>

<q>A wise person marvels at the commonplace.</q>
<cite>Confucius</cite>

<ul>
	<li><a href='https://git.sr.ht/~rabbits/fractran' target='_blank'>Fractran Interpreter(C89)</a></li>
	<li><a href='https://tjwei.github.io/Fractran' target='_blank'>Fractran Interpreter(Web)</a></li>
	<li><a href='https://esoteric.codes/blog/an-intro-to-fractran' target='_blank'>Intro to Fractran</a></li>
	<li><a href='https://esolangs.org/wiki/Fractran' target='_blank'>Article on Esolang</a></li>
	<li><a href='https://esolangs.org/wiki/Collatz_function' target='_blank'>Collatz function</a></li>
	<li><a href='https://en.wikipedia.org/wiki/Register_machine' target='_blank'>Register Machine</a></li>
	<li><a href='https://raganwald.com/2020/05/03/fractran.html' target='_blank'>Remembering John Conway</a></li>
</ul>

<style>
	.numreg { background:pink; color: black }
	.numval { background:#ffdee4; color: black }
	.denreg { background:#72dec2; color: black }
	.denval { background:#ffd18c; color: black }
</style>
<ul></ul><p class="incoming"><b>incoming</b> <a href="phutball.html">phutball</a> <a href="firth.html">firth</a> <a href="primes.html">primes</a> <a href="fractions.html">fractions</a> </p></main>
<footer><a href="https://webring.xxiivv.com/" target="_blank"><img src="../media/icon/webring.svg" alt="Webring"/></a><a href="https://merveilles.town/@neauoire" rel="me" target="_blank"><img src="../media/icon/verse.svg" alt="Merveilles"/></a><a href="ethics.html"><img src="../media/icon/dreipfeile.svg" alt="NoNazis!"/></a><a href="uxn.html"><img src="../media/icon/uxn.svg" alt="UxnPowered"/></a><span> <a href="devine_lu_linvega.html">Devine Lu Linvega</a> &copy; 2008-2024</span><div class="right"><a href="about.html#license">BY-NC-SA 4.0</a><a href="https://creativecommons.org/licenses/by-nc-sa/4.0" target="_blank"><img src="../media/icon/cc.svg" alt="CreativeCommons"/></a></div><hr/></footer>
</body></html>